"""
	Assigns to each malware the good family (directory) according to a CSV file.

	Author: Beno√Æt Michel
	Date : June 2021
"""

import os
import csv
import shutil

file = "./Malwares/trainLabels.csv"
directory = "./Malwares/train"

"""
file = "./Malwares/sampleSubmission.csv"
directory = "./Malwares/test"
"""

malwares_name = list()
malwares_family = list()

# Reads the csv and puts each of the two rows in a list
with open(file) as csvfile:
    reader = csv.reader(csvfile, delimiter=",")
    for row in reader:
        malwares_name.append(row[0])
        malwares_family.append(row[1])

    # Remove the description of the rows
    malwares_name = malwares_name[1:]
    malwares_family = malwares_family[1:]

    print(malwares_name)
    print(malwares_family)

    # Assign to each malware the good family directory
    for i in range(len(malwares_name)):
        print(i)
        name = malwares_name[i]
        family = malwares_family[i]
        if not os.path.exists(os.path.join(directory, family)):
            os.mkdir(os.path.join(directory, family))
        print(shutil.move(os.path.join(directory, name+".bytes"), os.path.join(directory, family)))

    print("Successfull transfer !")
